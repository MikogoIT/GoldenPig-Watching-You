<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>调试版本</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <h1>调试版本</h1>
        <div id="debug-info">
            <p>状态: <span id="debug-status">加载中...</span></p>
            <p>单元格数: <span id="debug-count">0</span></p>
            <p>错误: <span id="debug-error">无</span></p>
        </div>
        
        <div class="table-container">
            <table id="line-table">
                <tr>
                    <th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th>
                    <th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th>N</th><th>O</th><th>P</th>
                    <th>Q</th><th>R</th><th>S</th><th>T</th>
                </tr>
                <!-- 测试行 -->
                <tr>
                    <td data-line="1">1<div class="timer-display" id="timer-1"></div></td>
                    <td data-line="2">2<div class="timer-display" id="timer-2"></div></td>
                    <td data-line="3">3<div class="timer-display" id="timer-3"></div></td>
                    <td data-line="4">4<div class="timer-display" id="timer-4"></div></td>
                    <td data-line="5">5<div class="timer-display" id="timer-5"></div></td>
                    <td data-line="6">6<div class="timer-display" id="timer-6"></div></td>
                    <td data-line="7">7<div class="timer-display" id="timer-7"></div></td>
                    <td data-line="8">8<div class="timer-display" id="timer-8"></div></td>
                    <td data-line="9">9<div class="timer-display" id="timer-9"></div></td>
                    <td data-line="10">10<div class="timer-display" id="timer-10"></div></td>
                    <td data-line="11">11<div class="timer-display" id="timer-11"></div></td>
                    <td data-line="12">12<div class="timer-display" id="timer-12"></div></td>
                    <td data-line="13">13<div class="timer-display" id="timer-13"></div></td>
                    <td data-line="14">14<div class="timer-display" id="timer-14"></div></td>
                    <td data-line="15">15<div class="timer-display" id="timer-15"></div></td>
                    <td data-line="16">16<div class="timer-display" id="timer-16"></div></td>
                    <td data-line="17">17<div class="timer-display" id="timer-17"></div></td>
                    <td data-line="18">18<div class="timer-display" id="timer-18"></div></td>
                    <td data-line="19">19<div class="timer-display" id="timer-19"></div></td>
                    <td data-line="20">20<div class="timer-display" id="timer-20"></div></td>
                </tr>
            </table>
        </div>
    </div>

    <script type="module">
        import { TableManager } from './js/modules/tableManager.js';
        
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                document.getElementById('debug-status').textContent = '开始初始化';
                console.log('开始初始化调试版本');
                
                const table = document.getElementById('line-table');
                if (!table) {
                    throw new Error('未找到表格元素');
                }
                
                // 创建简单的事件管理器
                const eventManager = {
                    handleCellClick: (e) => {
                        const cell = e.currentTarget;
                        cell.classList.toggle('killed');
                        console.log('单击单元格:', cell.dataset.line);
                    },
                    handleCellRightClick: (e) => {
                        e.preventDefault();
                        const cell = e.currentTarget;
                        cell.classList.toggle('killed-unknown');
                        console.log('右击单元格:', cell.dataset.line);
                    },
                    handleCellDoubleClick: (e) => {
                        const cell = e.currentTarget;
                        cell.classList.remove('killed', 'killed-unknown', 'refreshed');
                        console.log('双击单元格:', cell.dataset.line);
                    },
                    addMobileTripleClickEvent: (cell) => {
                        console.log('添加移动端事件:', cell.dataset.line);
                    }
                };
                
                document.getElementById('debug-status').textContent = '创建表格管理器';
                const tableManager = new TableManager();
                
                document.getElementById('debug-status').textContent = '初始化表格';
                tableManager.initializeTable(table, eventManager);
                
                const cellCount = table.querySelectorAll('td[data-line]').length;
                document.getElementById('debug-count').textContent = cellCount;
                document.getElementById('debug-status').textContent = '初始化完成';
                
                console.log('调试版本初始化成功，单元格数量:', cellCount);
                
            } catch (error) {
                console.error('调试版本初始化失败:', error);
                document.getElementById('debug-error').textContent = error.message;
                document.getElementById('debug-status').textContent = '初始化失败';
            }
        });
    </script>
</body>
</html>

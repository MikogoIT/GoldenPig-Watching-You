<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>表格调试</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #2c3e50; color: white; }
        table { width: 100%; border-collapse: separate; border-spacing: 2px; }
        td { 
            background: #34495e; 
            color: white; 
            padding: 10px; 
            text-align: center; 
            border-radius: 5px; 
            position: relative;
            height: 50px;
            width: 5%;
        }
        .timer-display {
            position: absolute;
            bottom: 2px;
            left: 2px;
            right: 2px;
            font-size: 8px;
            background: rgba(0,0,0,0.7);
            color: white;
            border-radius: 2px;
            padding: 1px;
            text-align: center;
        }
        .debug-info { margin: 20px 0; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 5px; }
    </style>
</head>
<body>
    <h1>🔧 表格生成调试</h1>
    
    <div class="debug-info">
        <h3>调试信息</h3>
        <p>表格状态: <span id="table-status">检查中...</span></p>
        <p>单元格数量: <span id="cell-count">0</span></p>
        <p>定时器元素数量: <span id="timer-count">0</span></p>
    </div>
    
    <table id="debug-table">
        <tr>
            <th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th>
            <th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th>N</th><th>O</th><th>P</th>
            <th>Q</th><th>R</th><th>S</th><th>T</th>
        </tr>
    </table>

    <script type="module">
        import { TableManager } from './js/modules/tableManager.js';
        
        // 模拟事件管理器
        const mockEventManager = {
            addMobileTripleClickEvent: () => {},
            handleCellClick: () => {},
            handleCellRightClick: () => {},
            handleCellDoubleClick: () => {}
        };
        
        const tableManager = new TableManager();
        const table = document.getElementById('debug-table');
        
        try {
            console.log('开始生成表格...');
            tableManager.initializeTable(table, mockEventManager);
            
            // 检查结果
            const cells = table.querySelectorAll('td[data-line]');
            const timers = table.querySelectorAll('.timer-display');
            
            document.getElementById('table-status').textContent = '✅ 生成成功';
            document.getElementById('cell-count').textContent = cells.length;
            document.getElementById('timer-count').textContent = timers.length;
            
            console.log(`表格生成完成: ${cells.length} 个单元格, ${timers.length} 个定时器`);
            
            // 测试几个单元格
            if (cells.length > 0) {
                console.log('前5个单元格的data-line属性:', 
                    Array.from(cells).slice(0, 5).map(c => c.dataset.line));
            }
            
        } catch (error) {
            console.error('表格生成失败:', error);
            document.getElementById('table-status').textContent = '❌ 生成失败: ' + error.message;
        }
    </script>
</body>
</html>
